<!-- AIèŠå¤©æ¨¡å— - ç²˜è´´åˆ°</body>å‰ï¼Œä¸æ”¹åŠ¨åŸæœ‰å†…å®¹ -->
<style>
  /* å…¨å±€åŠ¨ç”»å˜é‡ï¼ˆä¸æ»‘è¿‡æ¸¡ï¼‰ */
  :root {
    --animate-duration: 0.3s;
    --primary-color: #ff6700; /* æ±‰å ¡ä¸»é¢˜æ©™ï¼Œå¯æ ¹æ®ä½ ç½‘ç«™è°ƒæ•´ */
    --secondary-color: #fff;
    --bg-color: #f8f8f8;
    --shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  /* åŠ¨ç”»ç±» */
  .fade-in {
    animation: fadeIn var(--animate-duration) ease forwards;
  }
  .slide-up {
    animation: slideUp var(--animate-duration) ease forwards;
  }
  .scale-in {
    animation: scaleIn var(--animate-duration) ease forwards;
  }
  .rotate-loading {
    animation: rotate 1s linear infinite;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  @keyframes slideUp {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  @keyframes scaleIn {
    from { transform: scale(0.95); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }
  @keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  /* AIèŠå¤©èœå•æŒ‰é’®ï¼ˆæ‚¬æµ®å›ºå®šï¼‰ */
  .ai-menu-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--primary-color);
    color: var(--secondary-color);
    border: none;
    font-size: 20px;
    cursor: pointer;
    box-shadow: var(--shadow);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  .ai-menu-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  }

  /* AIèŠå¤©ä¸»é¢æ¿ */
  .ai-chat-panel {
    position: fixed;
    bottom: 100px;
    right: 30px;
    width: 420px;
    border-radius: 16px;
    background: var(--secondary-color);
    box-shadow: var(--shadow);
    z-index: 9998;
    opacity: 0;
    transform: translateY(20px) scale(0.95);
    pointer-events: none;
    transition: all var(--animate-duration) ease;
    overflow: hidden;
  }
  .ai-chat-panel.show {
    opacity: 1;
    transform: translateY(0) scale(1);
    pointer-events: all;
  }

  /* èŠå¤©é¢æ¿å¤´éƒ¨ */
  .ai-chat-header {
    padding: 16px 20px;
    background: var(--primary-color);
    color: var(--secondary-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .ai-chat-title {
    font-size: 18px;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .ai-chat-title span {
    font-size: 12px;
    opacity: 0.8;
    font-weight: normal;
  }
  .ai-close-btn {
    background: transparent;
    border: none;
    color: var(--secondary-color);
    font-size: 20px;
    cursor: pointer;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  .ai-close-btn:hover {
    background: rgba(255,255,255,0.2);
  }

  /* æ¨¡å‹é€‰æ‹©åŒº */
  .ai-model-selector {
    padding: 12px 20px;
    background: var(--bg-color);
    display: flex;
    align-items: center;
    gap: 10px;
    border-bottom: 1px solid #eee;
  }
  .ai-model-selector label {
    font-size: 14px;
    color: #666;
    font-weight: 500;
  }
  .ai-model-select {
    flex: 1;
    padding: 6px 10px;
    border-radius: 8px;
    border: 1px solid #ddd;
    outline: none;
    font-size: 14px;
    transition: border 0.2s ease;
  }
  .ai-model-select:focus {
    border-color: var(--primary-color);
  }

  /* èŠå¤©å†…å®¹åŒº */
  .ai-chat-content {
    height: 400px;
    padding: 16px 20px;
    overflow-y: auto;
    background: var(--bg-color);
    scrollbar-width: thin;
    scrollbar-color: var(--primary-color) transparent;
  }
  .ai-chat-content::-webkit-scrollbar {
    width: 6px;
  }
  .ai-chat-content::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 3px;
  }

  /* æ¶ˆæ¯æ ·å¼ */
  .msg-item {
    margin-bottom: 16px;
    animation: slideUp var(--animate-duration) ease forwards;
  }
  .msg-user {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
  }
  .msg-ai {
    display: flex;
    justify-content: flex-start;
    gap: 8px;
  }
  .msg-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--primary-color);
    color: var(--secondary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: bold;
    flex-shrink: 0;
  }
  .msg-user .msg-avatar {
    background: #409eff;
  }
  .msg-content {
    max-width: 70%;
    padding: 10px 14px;
    border-radius: 12px;
    line-height: 1.5;
    font-size: 14px;
  }
  .msg-user .msg-content {
    background: var(--primary-color);
    color: var(--secondary-color);
    border-bottom-right-radius: 4px;
  }
  .msg-ai .msg-content {
    background: var(--secondary-color);
    color: #333;
    border: 1px solid #eee;
    border-bottom-left-radius: 4px;
  }

  /* å›¾ç‰‡æ¶ˆæ¯æ ·å¼ */
  .msg-image {
    max-width: 100%;
    border-radius: 8px;
    margin-top: 8px;
    cursor: pointer;
    transition: transform 0.2s ease;
  }
  .msg-image:hover {
    transform: scale(1.02);
  }

  /* åŠ è½½åŠ¨ç”» */
  .loading-dots {
    display: flex;
    gap: 4px;
    padding: 8px 12px;
  }
  .loading-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #999;
    animation: bounce 1s ease-in-out infinite;
  }
  .loading-dot:nth-child(2) {
    animation-delay: 0.2s;
  }
  .loading-dot:nth-child(3) {
    animation-delay: 0.4s;
  }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }

  /* è¾“å…¥åŒº */
  .ai-chat-input-area {
    padding: 16px 20px;
    background: var(--secondary-color);
    border-top: 1px solid #eee;
  }
  .ai-input-toolbar {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
  }
  .ai-tool-btn {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    border: 1px solid #eee;
    background: var(--bg-color);
    color: #666;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  .ai-tool-btn:hover {
    border-color: var(--primary-color);
    color: var(--primary-color);
    background: rgba(255,103,0,0.05);
  }
  #ai-image-upload {
    display: none;
  }

  .ai-input-wrap {
    display: flex;
    gap: 10px;
  }
  #ai-question-input {
    flex: 1;
    padding: 12px 16px;
    border-radius: 24px;
    border: 1px solid #eee;
    outline: none;
    font-size: 14px;
    resize: none;
    height: 48px;
    max-height: 120px;
    transition: border 0.2s ease;
  }
  #ai-question-input:focus {
    border-color: var(--primary-color);
  }
  #ai-send-btn {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: var(--primary-color);
    color: var(--secondary-color);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    flex-shrink: 0;
  }
  #ai-send-btn:hover {
    transform: scale(1.05);
    background: #e55a00;
  }
  #ai-send-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
  }

  /* é¢„è§ˆå›¾ç‰‡å¼¹çª— */
  .image-preview-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .image-preview-modal.show {
    display: flex;
    animation: fadeIn var(--animate-duration) ease forwards;
  }
  .preview-image {
    max-width: 90%;
    max-height: 90%;
    border-radius: 8px;
    animation: scaleIn var(--animate-duration) ease forwards;
  }
  .close-preview-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    color: white;
    border: none;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  .close-preview-btn:hover {
    background: rgba(255,255,255,0.4);
  }

  /* é€‚é…ç§»åŠ¨ç«¯ */
  @media (max-width: 500px) {
    .ai-chat-panel {
      width: calc(100% - 40px);
      right: 20px;
      bottom: 80px;
    }
    .ai-menu-btn {
      width: 50px;
      height: 50px;
      font-size: 18px;
    }
  }
</style>

<!-- AIèŠå¤©èœå•æŒ‰é’® -->
<button class="ai-menu-btn" id="ai-menu-btn">
  ğŸ”
</button>

<!-- AIèŠå¤©é¢æ¿ -->
<div class="ai-chat-panel" id="ai-chat-panel">
  <!-- å¤´éƒ¨ -->
  <div class="ai-chat-header">
    <div class="ai-chat-title">
      æ±‰å ¡ <span>(Hamburger)</span>
    </div>
    <button class="ai-close-btn" id="ai-close-btn">Ã—</button>
  </div>

  <!-- æ¨¡å‹é€‰æ‹© -->
  <div class="ai-model-selector">
    <label>é€‰æ‹©æ¨¡å‹ï¼š</label>
    <select class="ai-model-select" id="ai-model-select">
      <option value="chatgpt">ChatGPT (æ”¯æŒå›¾æ–‡)</option>
      <option value="douban">è±†åŒ… (æ”¯æŒå›¾æ–‡)</option>
      <option value="deepseek">DeepSeek (æ–‡å­—é—®ç­”)</option>
    </select>
  </div>

  <!-- èŠå¤©å†…å®¹ -->
  <div class="ai-chat-content" id="ai-chat-content">
    <div class="msg-item msg-ai">
      <div class="msg-avatar">ğŸ”</div>
      <div class="msg-content">
        ä½ å¥½å‘€ï½æˆ‘æ˜¯æ±‰å ¡ (Hamburger)ï¼Œæœ‰ä»€ä¹ˆæƒ³èŠçš„éƒ½å¯ä»¥é—®æˆ‘ ğŸ˜‹
      </div>
    </div>
  </div>

  <!-- è¾“å…¥åŒº -->
  <div class="ai-chat-input-area">
    <div class="ai-input-toolbar">
      <label for="ai-image-upload" class="ai-tool-btn" title="ä¸Šä¼ å›¾ç‰‡">
        ğŸ“·
      </label>
      <input type="file" id="ai-image-upload" accept="image/*">
    </div>
    <div class="ai-input-wrap">
      <textarea 
        id="ai-question-input" 
        placeholder="è¾“å…¥ä½ çš„é—®é¢˜ï¼Œæ±‰å ¡é©¬ä¸Šå›å¤ï½æ”¯æŒå›¾æ–‡æé—®å“¦ï½"
        maxlength="1000"
      ></textarea>
      <button id="ai-send-btn" disabled>â¤</button>
    </div>
  </div>
</div>

<!-- å›¾ç‰‡é¢„è§ˆå¼¹çª— -->
<div class="image-preview-modal" id="image-preview-modal">
  <img src="" alt="é¢„è§ˆå›¾ç‰‡" class="preview-image" id="preview-image">
  <button class="close-preview-btn" id="close-preview-btn">Ã—</button>
</div>

<script>
  // æ ¸å¿ƒé…ç½®
  const AI_NAME = {
    cn: "æ±‰å ¡",
    en: "Hamburger"
  };
  
  // æ¨¡å‹é…ç½®ï¼ˆæ”¯æŒå›¾æ–‡/æ–‡å­—ï¼‰
  const MODEL_CONFIG = {
    chatgpt: {
      name: "ChatGPT",
      supportImage: true,
      url: "https://api-free.chatanywhere.com.cn/v1/chat/completions",
      key: "sk-4V26T8A94u1858U68861v85816686688959552926255054",
      model: "gpt-4o-mini", // æ”¯æŒå›¾æ–‡çš„è½»é‡æ¨¡å‹
      prompt: `ä½ æ˜¯å«${AI_NAME.cn}(${AI_NAME.en})çš„å¯çˆ±AIåŠ©æ‰‹ï¼Œå›ç­”äº²åˆ‡ã€æ´»æ³¼ã€åƒæœ‹å‹èŠå¤©ï¼Œå¤šç”¨è½»æ¾çš„è¯­æ°”å’Œè¡¨æƒ…ç¬¦å·ã€‚`
    },
    douban: {
      name: "è±†åŒ…",
      supportImage: true,
      url: "https://www.xiaoyaoproxy.com/api/chat/completions",
      key: "sk-0a3b4c5d6e7f8g9h0i1j2k3l4m5n6o7p8q9r0s1t2u3v4w5x6y7z8a9b0c1d2e3f4g5h6i7j8k9l0m1n2o3p4q5r6s7t8u9v0w1x2y3z4a5b6c7d8e9f0g1h2i3j4k5l6m7n8o9p0q1r2s3t4u5v6w7x8y9z0a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9x0y1z2a3b4c5d6e7f8g9h0i1j2",
      model: "doubao-pro",
      prompt: `ä½ æ˜¯å«${AI_NAME.cn}(${AI_NAME.en})çš„å¯çˆ±AIåŠ©æ‰‹ï¼Œç†Ÿæ‚‰ä¸­æ–‡è¯­å¢ƒï¼Œå›ç­”æ¥åœ°æ°”ã€æœ‰æ¸©åº¦ï¼Œå¤šç”¨è½»æ¾çš„è¯­æ°”ã€‚`
    },
    deepseek: {
      name: "DeepSeek",
      supportImage: false,
      url: "https://api.deepseek.com/v1/chat/completions",
      key: "sk-88888888888888888888888888888888888888888888888",
      model: "deepseek-chat",
      prompt: `ä½ æ˜¯å«${AI_NAME.cn}(${AI_NAME.en})çš„å¯çˆ±AIåŠ©æ‰‹ï¼Œå›ç­”ç®€æ´æ˜“æ‡‚ï¼Œé€‚é…ä¸­æ–‡æ—¥å¸¸å¯¹è¯ï¼Œå¤šç”¨è½»æ¾çš„è¯­æ°”ã€‚`
    }
  };

  // DOMå…ƒç´ 
  const menuBtn = document.getElementById('ai-menu-btn');
  const chatPanel = document.getElementById('ai-chat-panel');
  const closeBtn = document.getElementById('ai-close-btn');
  const chatContent = document.getElementById('ai-chat-content');
  const questionInput = document.getElementById('ai-question-input');
  const sendBtn = document.getElementById('ai-send-btn');
  const modelSelect = document.getElementById('ai-model-select');
  const imageUpload = document.getElementById('ai-image-upload');
  const imagePreviewModal = document.getElementById('image-preview-modal');
  const previewImage = document.getElementById('preview-image');
  const closePreviewBtn = document.getElementById('close-preview-btn');

  // å…¨å±€å˜é‡
  let uploadedImage = null; // å­˜å‚¨ä¸Šä¼ çš„å›¾ç‰‡

  // åˆå§‹åŒ–ï¼šèœå•æ˜¾ç¤º/éšè—
  menuBtn.addEventListener('click', () => {
    chatPanel.classList.toggle('show');
  });
  closeBtn.addEventListener('click', () => {
    chatPanel.classList.remove('show');
  });

  // è¾“å…¥æ¡†çŠ¶æ€ï¼šæœ‰å†…å®¹æ‰æ¿€æ´»å‘é€æŒ‰é’®
  questionInput.addEventListener('input', () => {
    const hasContent = questionInput.value.trim().length > 0 || uploadedImage;
    sendBtn.disabled = !hasContent;
  });

  // å›¾ç‰‡ä¸Šä¼ å¤„ç†
  imageUpload.addEventListener('change', async (e) => {
    const file = e.target.files[0];
    if (!file) return;

    // éªŒè¯å›¾ç‰‡æ ¼å¼å’Œå¤§å°
    if (!file.type.startsWith('image/')) {
      addMsg('è¯·ä¸Šä¼ å›¾ç‰‡æ ¼å¼çš„æ–‡ä»¶å“¦ï½', false);
      return;
    }
    if (file.size > 10 * 1024 * 1024) { // 10MBé™åˆ¶
      addMsg('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡10MBå“¦ï½', false);
      return;
    }

    // è½¬æ¢ä¸ºbase64
    const reader = new FileReader();
    reader.onload = (event) => {
      uploadedImage = {
        data: event.target.result.split(',')[1], // æå–base64å†…å®¹
        type: file.type
      };
      // æ˜¾ç¤ºå›¾ç‰‡ä¸Šä¼ æˆåŠŸçš„æç¤º
      addMsg(`å·²ä¸Šä¼ å›¾ç‰‡ âœ…ï¼Œå¯ä»¥è¾“å…¥é—®é¢˜ä¸€èµ·å‘é€å•¦ï½`, false);
      questionInput.focus();
    };
    reader.readAsDataURL(file);
  });

  // å›¾ç‰‡é¢„è§ˆ
  chatContent.addEventListener('click', (e) => {
    if (e.target.classList.contains('msg-image')) {
      previewImage.src = e.target.src;
      imagePreviewModal.classList.add('show');
    }
  });
  closePreviewBtn.addEventListener('click', () => {
    imagePreviewModal.classList.remove('show');
  });
  imagePreviewModal.addEventListener('click', (e) => {
    if (e.target === imagePreviewModal) {
      imagePreviewModal.classList.remove('show');
    }
  });

  // æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©æ¡†
  function addMsg(content, isUser = false, imageUrl = null) {
    const msgItem = document.createElement('div');
    msgItem.className = `msg-item ${isUser ? 'msg-user' : 'msg-ai'}`;
    
    const avatar = document.createElement('div');
    avatar.className = 'msg-avatar';
    avatar.innerHTML = isUser ? 'ğŸ‘¤' : 'ğŸ”';
    
    const msgContent = document.createElement('div');
    msgContent.className = 'msg-content';
    msgContent.textContent = content;

    // å¦‚æœæœ‰å›¾ç‰‡ï¼Œæ·»åŠ å›¾ç‰‡å…ƒç´ 
    if (imageUrl) {
      const img = document.createElement('img');
      img.src = imageUrl;
      img.className = 'msg-image';
      img.alt = 'èŠå¤©å›¾ç‰‡';
      msgContent.appendChild(img);
    }

    msgItem.appendChild(avatar);
    msgItem.appendChild(msgContent);
    chatContent.appendChild(msgItem);
    
    // æ»šåŠ¨åˆ°åº•éƒ¨
    chatContent.scrollTop = chatContent.scrollHeight;
    
    return msgItem;
  }

  // æ·»åŠ åŠ è½½åŠ¨ç”»
  function addLoadingMsg() {
    const msgItem = document.createElement('div');
    msgItem.className = 'msg-item msg-ai';
    msgItem.id = 'loading-msg';
    
    const avatar = document.createElement('div');
    avatar.className = 'msg-avatar';
    avatar.innerHTML = 'ğŸ”';
    
    const loadingDots = document.createElement('div');
    loadingDots.className = 'loading-dots';
    loadingDots.innerHTML = `
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
    `;

    msgItem.appendChild(avatar);
    msgItem.appendChild(loadingDots);
    chatContent.appendChild(msgItem);
    chatContent.scrollTop = chatContent.scrollHeight;
    
    return msgItem;
  }

  // ç§»é™¤åŠ è½½åŠ¨ç”»
  function removeLoadingMsg() {
    const loadingMsg = document.getElementById('loading-msg');
    if (loadingMsg) {
      loadingMsg.remove();
    }
  }

  // å‘é€æ¶ˆæ¯æ ¸å¿ƒé€»è¾‘
  async function sendMsg() {
    const question = questionInput.value.trim();
    const selectedModel = modelSelect.value;
    const config = MODEL_CONFIG[selectedModel];

    // éªŒè¯ï¼šæ— å†…å®¹ä¸”æ— å›¾ç‰‡åˆ™è¿”å›
    if (!question && !uploadedImage) {
      addMsg('åˆ«å®³ç¾å‘€ï½è¾“å…¥é—®é¢˜æˆ–ä¸Šä¼ å›¾ç‰‡æˆ‘å°±å›ç­” ğŸ˜œ', false);
      return;
    }

    // éªŒè¯ï¼šé€‰æ‹©ä¸æ”¯æŒå›¾ç‰‡çš„æ¨¡å‹ä½†ä¸Šä¼ äº†å›¾ç‰‡
    if (uploadedImage && !config.supportImage) {
      addMsg(`ğŸ˜Ÿ ${config.name}æš‚æ—¶ä¸æ”¯æŒå›¾ç‰‡æé—®å“¦ï¼Œæ¢ChatGPTæˆ–è±†åŒ…è¯•è¯•å§ï½`, false);
      return;
    }

    // æ„å»ºç”¨æˆ·æ¶ˆæ¯å†…å®¹
    let userMsgContent = question || 'è¯·åˆ†æè¿™å¼ å›¾ç‰‡';
    // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯ï¼ˆåŒ…å«å›¾ç‰‡ï¼‰
    const userImageUrl = uploadedImage ? `data:${uploadedImage.type};base64,${uploadedImage.data}` : null;
    addMsg(userMsgContent, true, userImageUrl);

    // æ¸…ç©ºè¾“å…¥å’Œå›¾ç‰‡
    questionInput.value = '';
    uploadedImage = null;
    sendBtn.disabled = true;

    // æ·»åŠ åŠ è½½åŠ¨ç”»
    addLoadingMsg();

    try {
      // æ„å»ºè¯·æ±‚æ¶ˆæ¯ä½“
      let messages = [
        { role: "system", content: config.prompt },
      ];

      // å¤„ç†å›¾æ–‡æ¶ˆæ¯
      if (uploadedImage) {
        // å›¾æ–‡æ ¼å¼ï¼ˆGPT-4o-mini/è±†åŒ…ï¼‰
        messages.push({
          role: "user",
          content: [
            { type: "text", text: userMsgContent },
            { type: "image_url", image_url: { url: `data:${uploadedImage.type};base64,${uploadedImage.data}` } }
          ]
        });
      } else {
        // çº¯æ–‡å­—
        messages.push({ role: "user", content: userMsgContent });
      }

      // å‘é€è¯·æ±‚
      const response = await fetch(config.url, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${config.key}`
        },
        body: JSON.stringify({
          model: config.model,
          messages: messages,
          max_tokens: 2000,
          temperature: 0.8 // æ›´æ´»æ³¼çš„å›ç­”
        })
      });

      const data = await response.json();
      removeLoadingMsg();

      // å¤„ç†å“åº”
      if (data.choices?.[0]?.message?.content) {
        addMsg(data.choices[0].message.content, false);
      } else {
        addMsg(`ğŸ˜Ÿ æŠ±æ­‰ï¼Œ${config.name}æš‚æ—¶æœ‰ç‚¹å°é—®é¢˜ï¼Œæ¢ä¸ªæ¨¡å‹è¯•è¯•å§ï½`, false);
      }
    } catch (error) {
      removeLoadingMsg();
      addMsg('ğŸ¥º ç½‘ç»œæœ‰ç‚¹å°é—®é¢˜ï¼Œå†è¯•ä¸€æ¬¡å§ï½', false);
      console.error('å‘é€æ¶ˆæ¯å¤±è´¥ï¼š', error);
    }
  }

  // ç»‘å®šå‘é€äº‹ä»¶
  sendBtn.addEventListener('click', sendMsg);
  questionInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMsg();
    }
  });

  // ç‚¹å‡»ç©ºç™½å¤„å…³é—­é¢æ¿ï¼ˆå¯é€‰ï¼‰
  document.addEventListener('click', (e) => {
    if (
      !chatPanel.contains(e.target) && 
      !menuBtn.contains(e.target) && 
      chatPanel.classList.contains('show')
    ) {
      chatPanel.classList.remove('show');
    }
  });
</script>
